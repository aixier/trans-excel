# Excel翻译系统 - 用户手册

## 📖 目录

1. [系统简介](#系统简介)
2. [快速上手](#快速上手)
3. [详细功能说明](#详细功能说明)
4. [常见问题](#常见问题)
5. [最佳实践](#最佳实践)

---

## 系统简介

Excel翻译系统是一个专业的批量翻译工具，支持将Excel文件中的内容翻译成多种语言。系统采用AI技术，支持上下文理解，确保翻译质量。

### 核心特性

- 🌍 **多语言支持**：支持中文、英文、土耳其语、泰语、葡萄牙语、越南语、印尼语、西班牙语
- 📊 **批量处理**：自动识别Excel中需要翻译的内容
- 🎯 **上下文理解**：基于游戏信息和相邻内容提供准确翻译
- 📈 **实时进度**：WebSocket实时显示翻译进度
- 💾 **自动保存**：8小时内可随时恢复中断的任务

---

## 快速上手

### 第1步：上传文件

1. 访问系统主页
2. 拖拽Excel文件到上传区域，或点击"选择文件"
3. （可选）填写游戏信息，帮助AI更好理解内容
4. 点击"上传并分析"

![上传界面示意]

**支持的文件**：
- 格式：.xlsx, .xls
- 大小：最大100MB
- 内容：自动识别需要翻译的单元格

### 第2步：配置翻译

1. 选择源语言（或保持自动检测）
2. 勾选目标语言（可多选）
3. 配置上下文选项：
   - ✅ 游戏信息：使用您提供的游戏背景
   - ✅ 单元格注释：读取Excel中的注释
   - ✅ 相邻单元格：参考周围内容
   - ✅ 内容特征：分析文本类型
   - ✅ 表格类型：识别表格用途

4. 点击"开始拆分任务"
5. 拆分完成后，点击"开始翻译"

**建议配置**：
- 📚 文档类：开启所有上下文选项
- ⚡ 快速测试：关闭上下文，提升速度
- 🎮 游戏文本：开启游戏信息和相邻单元格

### 第3步：监控执行

1. 系统自动跳转到执行页面
2. 实时查看：
   - 总体进度百分比
   - 当前处理的任务
   - 预计剩余时间
   - 翻译速度

3. 可随时：
   - ⏸️ 暂停：临时中断
   - ▶️ 继续：恢复执行
   - ⏹️ 停止：终止任务

### 第4步：下载结果

1. 翻译完成后自动跳转
2. 查看质量统计：
   - 成功率
   - 平均置信度
   - 质量分布

3. 点击"下载结果"保存翻译后的Excel文件

⚠️ **重要提醒**：请在8小时内下载，超时数据将被清除！

---

## 详细功能说明

### 🔄 会话管理

**会话机制**：
- 每次上传文件创建一个会话
- 会话有效期：8小时
- 临期提醒：剩余30分钟时警告

**恢复中断任务**：
1. 刷新页面或重新访问
2. 系统自动检测未完成任务
3. 点击"继续"恢复之前的进度

### 🌐 语言配置

**源语言**：
- 自动检测（推荐）
- 手动指定：中文/英文

**目标语言**（可多选）：
- 亚洲语言：中文、泰语、越南语、印尼语
- 欧洲语言：英文、葡萄牙语、西班牙语
- 中东语言：土耳其语

### ⚙️ 上下文配置

| 选项 | 作用 | 建议场景 |
|------|------|----------|
| 游戏信息 | 提供背景知识 | 游戏本地化 |
| 单元格注释 | 理解特殊说明 | 有备注的文档 |
| 相邻单元格 | 保持一致性 | 表格数据 |
| 内容特征 | 识别文本类型 | 混合内容 |
| 表格类型 | 理解数据结构 | 结构化数据 |

### 📊 质量等级

- 🟢 **高质量（>90%）**：可直接使用
- 🟡 **中等（70-90%）**：建议复查
- 🔴 **低质量（<70%）**：需要人工校对
- ⚫ **失败**：需要重新翻译

### 🔌 连接状态

顶部导航栏显示连接状态：
- 🟢 **实时连接**：WebSocket正常
- 🟡 **兼容模式**：降级到轮询
- 🔴 **连接中**：正在重连

### 🎨 界面主题

点击顶部的 ☀️/🌙 图标切换亮色/暗色主题。

---

## 常见问题

### Q1: 为什么无法上传文件？

**检查事项**：
- 文件格式是否为.xlsx或.xls
- 文件大小是否超过100MB
- 浏览器是否支持（建议Chrome/Firefox）

### Q2: 翻译速度很慢怎么办？

**优化方法**：
1. 关闭上下文提取
2. 减少目标语言数量
3. 增加并发数（执行页面设置）

### Q3: 翻译质量不满意？

**改进建议**：
1. 开启所有上下文选项
2. 提供详细的游戏信息
3. 检查源文本是否清晰
4. 对低质量任务单独重译

### Q4: 会话过期了怎么办？

**解决方案**：
- 8小时内：刷新页面自动恢复
- 超过8小时：需要重新上传文件

### Q5: 同时只能执行一个任务？

**系统限制**：
- 后端同时只支持1个任务执行
- 等待当前任务完成后再开始新任务
- 可以先上传和配置，等待执行

### Q6: WebSocket连接失败？

**自动处理**：
- 系统会自动重试3次
- 失败后切换到轮询模式
- 不影响功能使用

---

## 最佳实践

### 📁 文件准备

**推荐做法**：
- ✅ 清理无关内容
- ✅ 统一格式规范
- ✅ 添加必要注释
- ✅ 备份原始文件

**避免**：
- ❌ 超大文件（拆分处理）
- ❌ 复杂公式（可能丢失）
- ❌ 合并单元格过多

### 🎯 配置选择

**高质量翻译**：
```
源语言：自动检测
目标语言：少量选择
上下文：全部开启
并发数：8
```

**快速翻译**：
```
源语言：手动指定
目标语言：单个
上下文：关闭
并发数：16
```

### 📈 性能优化

1. **分批处理**：大文件分成多个小文件
2. **错峰使用**：避开高峰时段
3. **重点处理**：优先翻译重要内容

### 🔍 质量控制

1. **预览检查**：下载前查看统计
2. **抽样验证**：检查部分结果
3. **重译低质量**：单独处理问题内容
4. **人工复核**：关键内容人工确认

### 💾 数据安全

1. **及时下载**：完成后立即下载
2. **本地备份**：保存Session ID
3. **分散风险**：重要内容分多次处理

---

## 键盘快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl + O` | 选择文件 |
| `Enter` | 确认/下一步 |
| `Esc` | 取消/关闭对话框 |
| `Space` | 暂停/继续（执行页） |

---

## 移动端使用

系统支持移动端访问，但建议：
- 📱 使用WiFi网络
- 📱 横屏显示效果更佳
- 📱 大文件建议PC端处理

---

## 技术支持

遇到问题？
1. 查看[常见问题](#常见问题)
2. 检查浏览器控制台错误
3. 联系技术支持团队

---

## 更新日志

### v2.0.0 (2025-01-20)
- ✨ 全新UI设计（daisyUI）
- ⚡ WebSocket实时更新
- 🔒 会话超时管理
- 📱 移动端适配
- 🌙 暗色主题支持

---

**祝您使用愉快！**